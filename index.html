<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elite Cards | Fix Pro</title>
    <style>
        :root { --gold: #d4af37; --felt: #0a5c36; --oro: #b8860b; --copa: #d32f2f; --espada: #1976d2; --basto: #388e3c; }
        body, html { margin: 0; padding: 0; height: 100%; background: #121212; color: white; font-family: sans-serif; overflow: hidden; }
        .screen { position: absolute; width: 100%; height: 100%; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .active { display: flex; }

        /* Estilos MenÃº */
        .card-menu { background: rgba(255,255,255,0.05); padding: 25px; border-radius: 20px; border: 1px solid var(--gold); text-align: center; width: 85%; max-width: 350px; }
        .btn-main { background: var(--gold); color: #000; border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; text-transform: uppercase; margin-bottom: 8px; }
        .btn-exit { background: #900; color: white; border: none; padding: 8px 15px; border-radius: 8px; font-weight: bold; cursor: pointer; position: absolute; top: 15px; left: 15px; font-size: 12px; z-index: 200; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; background: #eee; color: #000; }

        /* Estilos Juego */
        #screen-game { background: radial-gradient(circle, var(--felt) 0%, #052c1a 100%); }
        .scoreboard { position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.8); padding: 10px; border-radius: 10px; border: 1px solid var(--gold); font-size: 0.8rem; z-index: 100; }
        
        .hand { display: flex; gap: 8px; position: absolute; bottom: 25px; z-index: 10; }
        .card { 
            width: 70px; height: 105px; background: white; border-radius: 8px; color: black;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; border: 3px solid #333; cursor: pointer; position: relative;
        }
        .card[data-palo="Oros"] { color: var(--oro); border-color: var(--oro); }
        .card[data-palo="Copas"] { color: var(--copa); border-color: var(--copa); }
        .card[data-palo="Espadas"] { color: var(--espada); border-color: var(--espada); }
        .card[data-palo="Bastos"] { color: var(--basto); border-color: var(--basto); }

        #played-area { width: 100%; height: 140px; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .msg { position: absolute; top: 85px; background: rgba(0,0,0,0.6); padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; color: var(--gold); }
    </style>
</head>
<body>

    <div id="screen-login" class="screen active">
        <div class="card-menu">
            <h1 style="color:var(--gold); margin:0;">ELITE CARDS</h1>
            <input type="text" id="player-nick" placeholder="Tu Apodo">
            <p>Dificultad:</p>
            <select id="bot-difficulty">
                <option value="easy">FÃ¡cil ðŸŸ¢</option>
                <option value="hard">DifÃ­cil ðŸ”´</option>
            </select>
            <button class="btn-main" onclick="iniciarModoBot()">JUGAR CONTRA BOT</button>
        </div>
    </div>

    <div id="screen-game" class="screen">
        <button class="btn-exit" onclick="abandonarPartida()">âœ– ABANDONAR</button>
        
        <div class="scoreboard">
            TÃš: <span id="score-mine">0</span> | BOT: <span id="score-theirs">0</span>
        </div>
        
        <div id="turn-indicator" class="msg">Cargando...</div>
        
        <div id="played-area"></div>
        
        <div class="hand" id="my-hand"></div>
    </div>

    <script>
        let miNombre = "", miMano = [], manoBot = [], mazoActual = [];
        let puntosJugador = 0, puntosBot = 0;
        let turnoActual = "";
        let cartasEnMesa = [];
        let juegoTerminado = false;

        const ICONOS = { "Oros": "ðŸª™", "Copas": "ðŸ†", "Espadas": "âš”ï¸", "Bastos": "ðŸªµ" };

        function obtenerPoder(v, p) {
            if (v === 1 && p === "Espadas") return 14;
            if (v === 1 && p === "Bastos") return 13;
            if (v === 7 && p === "Espadas") return 12;
            if (v === 7 && p === "Oros") return 11;
            if (v === 3) return 10; if (v === 2) return 9; if (v === 1) return 8;
            return v;
        }

        function generarMazo() {
            const m = [];
            ["Oros", "Copas", "Espadas", "Bastos"].forEach(p => [1,2,3,4,5,6,7,10,11,12].forEach(v => m.push({valor:v, palo:p})));
            return m.sort(() => Math.random() - 0.5);
        }

        function repartirCartas() {
            mazoActual = generarMazo();
            miMano = [mazoActual[0], mazoActual[2], mazoActual[4]];
            manoBot = [mazoActual[1], mazoActual[3], mazoActual[5]];
        }

        function iniciarModoBot() {
            miNombre = document.getElementById('player-nick').value || "Jugador";
            puntosJugador = 0; puntosBot = 0; juegoTerminado = false;
            cartasEnMesa = [];
            
            document.getElementById('screen-login').style.display = 'none';
            document.getElementById('screen-game').style.display = 'flex';
            
            repartirCartas();
            turnoActual = miNombre;
            actualizarInterfaz();
        }

        function abandonarPartida() {
            if(confirm("Â¿Seguro que quieres abandonar la partida?")) {
                location.reload();
            }
        }

        function tirarCartaJugador(index) {
            if (turnoActual !== miNombre || cartasEnMesa.length >= 2 || juegoTerminado) return;

            const carta = miMano.splice(index, 1)[0];
            cartasEnMesa.push({ jugador: miNombre, carta: carta });
            
            if (cartasEnMesa.length === 1) {
                turnoActual = "Bot";
                actualizarInterfaz();
                setTimeout(decisionBot, 1000);
            } else {
                actualizarInterfaz();
                verificarGanadorRonda();
            }
        }

        function decisionBot() {
            if (juegoTerminado) return;
            const dif = document.getElementById('bot-difficulty').value;
            let index = 0;

            if (dif === "hard" && cartasEnMesa.length === 1) {
                const pJugador = obtenerPoder(cartasEnMesa[0].carta.valor, cartasEnMesa[0].carta.palo);
                manoBot.sort((a,b) => obtenerPoder(a.valor, a.palo) - obtenerPoder(b.valor, b.palo));
                let mejorOpcion = manoBot.findIndex(c => obtenerPoder(c.valor, c.palo) > pJugador);
                index = mejorOpcion !== -1 ? mejorOpcion : 0;
            } else {
                index = Math.floor(Math.random() * manoBot.length);
            }

            const carta = manoBot.splice(index, 1)[0];
            cartasEnMesa.push({ jugador: "Bot", carta: carta });
            
            if (cartasEnMesa.length === 1) {
                turnoActual = miNombre;
                actualizarInterfaz();
            } else {
                actualizarInterfaz();
                verificarGanadorRonda();
            }
        }

        function verificarGanadorRonda() {
            setTimeout(() => {
                const p1 = obtenerPoder(cartasEnMesa[0].carta.valor, cartasEnMesa[0].carta.palo);
                const p2 = obtenerPoder(cartasEnMesa[1].carta.valor, cartasEnMesa[1].carta.palo);
                
                const ganador = (p1 >= p2) ? cartasEnMesa[0].jugador : cartasEnMesa[1].jugador;
                
                if (ganador === miNombre) puntosJugador++;
                else puntosBot++;

                cartasEnMesa = [];
                turnoActual = ganador;

                // Si se acaban las 3 cartas de la mano
                if (miMano.length === 0) {
                    repartirCartas();
                }

                if (puntosJugador >= 15 || puntosBot >= 15) {
                    juegoTerminado = true;
                    alert("Â¡FIN DEL JUEGO! Ganador: " + (puntosJugador >= 15 ? miNombre : "Bot"));
                    location.reload();
                }

                actualizarInterfaz();

                // Si ganÃ³ el BOT la ronda, le toca empezar la siguiente
                if (turnoActual === "Bot") {
                    setTimeout(decisionBot, 1000);
                }
            }, 1200);
        }

        function actualizarInterfaz() {
            document.getElementById('score-mine').innerText = puntosJugador;
            document.getElementById('score-theirs').innerText = puntosBot;
            document.getElementById('turn-indicator').innerText = turnoActual === miNombre ? "TU TURNO" : "Bot pensando...";

            const handDiv = document.getElementById('my-hand');
            handDiv.innerHTML = "";
            miMano.forEach((c, i) => {
                const div = document.createElement('div');
                div.className = 'card';
                div.setAttribute('data-palo', c.palo);
                div.innerHTML = `<div>${c.valor}</div><div>${ICONOS[c.palo]}</div>`;
                div.onclick = () => tirarCartaJugador(i);
                handDiv.appendChild(div);
            });

            const tableDiv = document.getElementById('played-area');
            tableDiv.innerHTML = "";
            cartasEnMesa.forEach(t => {
                const div = document.createElement('div');
                div.className = 'card';
                div.setAttribute('data-palo', t.carta.palo);
                div.style.cursor = "default";
                div.innerHTML = `<div>${t.carta.valor}</div><div>${ICONOS[t.carta.palo]}</div>`;
                tableDiv.appendChild(div);
            });
        }
    </script>
</body>
</html>
