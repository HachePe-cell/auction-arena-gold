<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grand Auctioneer: Antiquities</title>
    <style>
        :root {
            --gold: #c5a059; --dark-oak: #1a0f0a; --velvet: #4a0404;
            --cream: #f4e4bc; --bronze: #8c7853;
        }
        
        body { 
            background: var(--dark-oak); color: var(--cream); font-family: 'Times New Roman', serif;
            margin: 0; overflow: hidden; height: 100vh;
            background-image: radial-gradient(circle, #2c1e14 0%, #0a0a0a 100%);
        }

        /* --- UI Screens --- */
        .screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; box-sizing: border-box; z-index: 10;
        }
        .active { display: flex; }

        /* --- Realistic Textures --- */
        .wood-panel {
            background: linear-gradient(145deg, #231710, #1a0f0a);
            border: 3px solid var(--gold); border-radius: 4px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8), 0 10px 30px rgba(0,0,0,1);
        }

        /* --- Header & Stats --- */
        .hud {
            position: absolute; top: 0; width: 100%; padding: 20px;
            display: flex; justify-content: space-between; align-items: center;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
        }

        /* --- Auction Room Layout --- */
        .auction-layout {
            display: grid; grid-template-columns: 1fr 300px; gap: 20px;
            width: 100%; max-width: 1000px; height: 80vh;
        }

        .item-display {
            display: flex; flex-direction: column; align-items: center;
            padding: 20px; text-align: center;
        }

        .spotlight {
            width: 100%; height: 350px; background: #000;
            border: 10px solid #222; position: relative;
            box-shadow: 0 0 100px rgba(197, 160, 89, 0.2);
            overflow: hidden;
        }
        .spotlight img { width: 100%; height: 100%; object-fit: cover; filter: sepia(0.2) contrast(1.1); }

        .bid-history {
            background: rgba(0,0,0,0.4); border-left: 1px solid var(--bronze);
            padding: 15px; overflow-y: auto; font-size: 0.9rem;
        }
        .bid-log { margin-bottom: 8px; border-bottom: 1px solid rgba(140, 120, 83, 0.2); padding-bottom: 4px; }

        /* --- Controls --- */
        .control-bar {
            width: 100%; padding: 20px; display: flex; justify-content: center; gap: 20px;
            background: var(--velvet); border-top: 2px solid var(--gold);
        }

        .btn-auction {
            background: var(--gold); color: black; border: 1px solid #000;
            padding: 15px 30px; font-weight: bold; cursor: pointer;
            text-transform: uppercase; letter-spacing: 2px;
        }
        .btn-auction:hover { background: #e0bb72; }

        /* --- Animations --- */
        @keyframes flash { from { opacity: 0.5; } to { opacity: 1; } }
        .winning { animation: flash 0.5s infinite alternate; color: #4ade80 !important; }

        .condition-tag {
            background: var(--bronze); color: white; padding: 2px 10px;
            font-size: 0.7rem; text-transform: uppercase; margin-top: 10px;
        }
    </style>
</head>
<body>

    <div id="setup-screen" class="screen active">
        <div class="wood-panel" style="padding: 40px; text-align: center;">
            <h1 style="color: var(--gold); margin-top:0;">REGISTRO DE √âLITE</h1>
            <p>Ingrese su Identificaci√≥n de Postor:</p>
            <input type="text" id="username" placeholder="Nombre del Coleccionista..." style="background:none; border:none; border-bottom:1px solid var(--gold); color:white; padding:10px; text-align:center; font-size:1.2rem; width:100%;">
            
            <p style="margin-top:30px;">Elija su Especialidad (T√≥tem):</p>
            <div style="display:flex; gap:10px; justify-content:center; margin-bottom:30px;">
                <button onclick="pickSkill('eye')" id="s-eye" class="btn-auction" style="font-size:0.7rem;">ü¶Ö Ojo Cl√≠nico<br>(Ve el valor real)</button>
                <button onclick="pickSkill('silver')" id="s-silver" class="btn-auction" style="font-size:0.7rem;">ü™ô Lengua de Plata<br>(-10% precio final)</button>
            </div>
            <button class="btn-auction" onclick="initApp()">INGRESAR A LA LOGIA</button>
        </div>
    </div>

    <div id="menu-screen" class="screen">
        <div class="hud">
            <div><span id="p-totem"></span> <span id="p-name" style="color:var(--gold)"></span></div>
            <div style="font-size:1.5rem;">Saldo: <span id="p-balance" style="color:var(--gold)">$1,000</span></div>
        </div>
        <h1 style="font-size: 3.5rem; letter-spacing: 10px; text-align:center;">THE GRAND<br>AUCTIONEER</h1>
        <div style="display:flex; flex-direction:column; gap:15px;">
            <button class="btn-auction" onclick="startAuction()">ENTRAR A LA SALA</button>
            <button class="btn-auction" style="background:none; color:var(--gold)" onclick="showMarket()">MI GALER√çA PRIVADA</button>
        </div>
    </div>

    <div id="auction-screen" class="screen" style="padding:0;">
        <div class="hud">
            <button onclick="exitAuction()" style="background:none; border:none; color:var(--gold); cursor:pointer;">‚üµ RETIRARSE</button>
            <div id="timer-display" style="font-size: 2rem; color:var(--gold)">15s</div>
        </div>

        <div class="auction-layout">
            <div class="item-display">
                <div class="spotlight">
                    <img id="item-img" src="">
                </div>
                <div class="condition-tag" id="item-condition">Excelente Estado</div>
                <h2 id="item-title" style="font-size: 2rem; margin:10px 0;">Objeto de Arte</h2>
                <div style="font-size: 3rem; color:var(--gold); font-weight:bold;">$<span id="live-bid">0</span></div>
                <p id="current-leader" style="font-style:italic; color:#aaa;">Esperando apertura...</p>
            </div>

            <div class="bid-history" id="bid-logs">
                <div style="text-align:center; color:var(--gold); margin-bottom:15px;">HISTORIAL DE LA SALA</div>
                </div>
        </div>

        <div class="control-bar">
            <button class="btn-auction" style="width:300px; font-size:1.2rem;" onclick="placeBid()">PUJAR +$100</button>
            <button class="btn-auction" style="background:var(--velvet); color:white;" onclick="useSkill()">HABILIDAD T√ìTEM</button>
        </div>
    </div>

    <div id="result-overlay" class="screen" style="background:rgba(0,0,0,0.95)">
        <h1 id="res-title" style="font-size:4rem; color:var(--gold);">VENDIDO</h1>
        <p id="res-desc" style="font-size:1.5rem;"></p>
        <button class="btn-auction" onclick="closeAuction()">VOLVER AL CLUB</button>
    </div>

    <script>
        let state = {
            user: { name: "", totem: "", balance: 2500, inventory: [] },
            auction: { active: false, bid: 0, leader: "", time: 15, item: null, logs: [] },
            skillUsed: false
        };

        const CATALOGO = [
            { name: "Gram√≥fono Edison Original", cond: "Funcional", base: 500, img: "https://images.unsplash.com/photo-1543336337-338274d8122c?w=600", val: 1200 },
            { name: "M√°scara Funeraria Egipcia", cond: "Restaurada", base: 2000, img: "https://images.unsplash.com/photo-1599423300746-b62533397364?w=600", val: 5000 },
            { name: "Viol√≠n Stradivarius 1715", cond: "Museo", base: 10000, img: "https://images.unsplash.com/photo-1612225330812-01a9c6b355ee?w=600", val: 25000 }
        ];

        const RIVALES = ["Lord Sterling", "Baronesa Rothschild", "Museo de Louvre", "Coleccionista An√≥nimo"];

        function initApp() {
            state.user.name = document.getElementById('username').value || "Invitado";
            if(!state.user.totem) state.user.totem = "Ojo Cl√≠nico";
            document.getElementById('p-name').innerText = state.user.name;
            document.getElementById('p-totem').innerText = state.user.totem === "eye" ? "ü¶Ö" : "ü™ô";
            showScreen('menu-screen');
        }

        function pickSkill(s) {
            state.user.totem = s;
            document.querySelectorAll('#s-eye, #s-silver').forEach(b => b.style.opacity = "0.5");
            document.getElementById('s-'+s).style.opacity = "1";
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            updateStats();
        }

        function updateStats() {
            document.getElementById('p-balance').innerText = "$" + state.user.balance.toLocaleString();
        }

        function startAuction() {
            let item = CATALOGO[Math.floor(Math.random() * CATALOGO.length)];
            state.auction = { 
                item: item, bid: item.base, leader: "La Casa", 
                time: 15, active: true, logs: ["Subasta iniciada por: " + item.name] 
            };
            state.skillUsed = false;
            document.getElementById('item-img').src = item.img;
            document.getElementById('item-title').innerText = item.name;
            document.getElementById('item-condition').innerText = "Condici√≥n: " + item.cond;
            document.getElementById('bid-logs').innerHTML = "";
            updateAuctionUI();
            showScreen('auction-screen');
            runTimer();
        }

        function runTimer() {
            let loop = setInterval(() => {
                if(!state.auction.active) { clearInterval(loop); return; }
                state.auction.time -= 0.1;
                document.getElementById('timer-display').innerText = Math.ceil(state.auction.time) + "s";
                
                // IA Realista: Puja si no es el l√≠der y el azar lo decide
                if(state.auction.time > 1 && Math.random() > 0.97 && state.auction.leader !== "Rival") {
                    botBid();
                }

                if(state.auction.time <= 0) {
                    state.auction.active = false;
                    finishAuction();
                }
            }, 100);
        }

        function placeBid() {
            if(state.user.balance < state.auction.bid + 100) return alert("Saldo insuficiente");
            state.auction.bid += 100;
            state.auction.leader = state.user.name;
            state.auction.time = Math.min(state.auction.time + 2, 8);
            addLog("Pujaste a $" + state.auction.bid, "user");
            updateAuctionUI();
        }

        function botBid() {
            let rival = RIVALES[Math.floor(Math.random()*RIVALES.length)];
            state.auction.bid += 100;
            state.auction.leader = "Rival";
            state.auction.time = Math.min(state.auction.time + 1.5, 6);
            addLog(rival + " sube a $" + state.auction.bid, "bot");
            updateAuctionUI();
        }

        function addLog(msg, type) {
            let log = document.createElement('div');
            log.className = "bid-log";
            log.style.color = type === "user" ? "var(--gold)" : "#aaa";
            log.innerText = "¬ª " + msg;
            const container = document.getElementById('bid-logs');
            container.prepend(log);
        }

        function updateAuctionUI() {
            document.getElementById('live-bid').innerText = state.auction.bid.toLocaleString();
            let leaderText = document.getElementById('current-leader');
            leaderText.innerText = "L√≠der actual: " + (state.auction.leader === state.user.name ? "USTED" : "COMPETIDOR");
            if(state.auction.leader === state.user.name) leaderText.classList.add('winning');
            else leaderText.classList.remove('winning');
        }

        function useSkill() {
            if(state.skillUsed) return;
            state.skillUsed = true;
            if(state.user.totem === 'eye') {
                alert("Tasaci√≥n Real: Este objeto se vende en galer√≠a por $" + state.auction.item.val);
            } else {
                alert("Lengua de Plata: Si ganas, el martillo cerrar√° un 20% m√°s barato.");
            }
        }

        function finishAuction() {
            const overlay = document.getElementById('result-overlay');
            if(state.auction.leader === state.user.name) {
                let cost = state.auction.bid;
                if(state.user.totem === 'silver' && state.skillUsed) cost *= 0.8;
                state.user.balance -= cost;
                state.user.inventory.push(state.auction.item);
                document.getElementById('res-title').innerText = "¬°ADJUDICADO!";
                document.getElementById('res-desc').innerText = "El objeto es suyo por $" + cost.toLocaleString();
            } else {
                document.getElementById('res-title').innerText = "VENDIDO";
                document.getElementById('res-desc').innerText = "La pieza fue ganada por otro postor.";
            }
            overlay.classList.add('active');
            localStorage.setItem('grand_auc_data', JSON.stringify(state.user));
        }

        function closeAuction() {
            document.getElementById('result-overlay').classList.remove('active');
            showScreen('menu-screen');
        }

        function exitAuction() {
            state.auction.active = false;
            showScreen('menu-screen');
        }
    </script>
</body>
</html>
