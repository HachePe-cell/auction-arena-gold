<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grand Auctioneer: Elite</title>
    <style>
        :root {
            --gold: #c5a059; --dark-oak: #1a0f0a; --velvet: #4a0404;
            --cream: #f4e4bc; --bronze: #8c7853;
        }
        body { 
            background: var(--dark-oak); color: var(--cream); font-family: 'Times New Roman', serif;
            margin: 0; overflow: hidden; height: 100vh;
        }
        .screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; box-sizing: border-box; background: radial-gradient(circle, #2c1e14 0%, #0a0a0a 100%);
        }
        .active { display: flex; }
        .wood-panel {
            background: #1a0f0a; border: 2px solid var(--gold); padding: 30px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8); text-align: center; max-width: 400px;
        }
        .hud {
            position: absolute; top: 0; width: 100%; padding: 15px;
            display: flex; justify-content: space-between; align-items: center; box-sizing: border-box;
        }
        .auction-layout {
            display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 500px;
        }
        .spotlight {
            width: 100%; height: 250px; background: #000; border: 4px solid var(--gold);
            margin-bottom: 15px; overflow: hidden;
        }
        .spotlight img { width: 100%; height: 100%; object-fit: cover; }
        .btn-auction {
            background: var(--gold); color: black; border: none; padding: 12px 25px;
            font-weight: bold; cursor: pointer; text-transform: uppercase; margin: 5px;
        }
        .btn-auction:disabled { opacity: 0.5; cursor: not-allowed; }
        #timer-display { font-size: 2rem; color: var(--gold); text-shadow: 0 0 10px rgba(197,160,89,0.5); }
        .log-box { width: 100%; height: 80px; background: rgba(0,0,0,0.5); overflow-y: auto; font-size: 0.8rem; margin: 10px 0; padding: 5px; border: 1px solid var(--bronze); }
    </style>
</head>
<body>

    <div id="setup-screen" class="screen active">
        <div class="wood-panel">
            <h1 style="color: var(--gold);">REGISTRO</h1>
            <input type="text" id="username" placeholder="Nombre del Coleccionista" style="width: 80%; padding: 10px; margin-bottom: 20px;">
            <div style="margin-bottom: 20px;">
                <button class="btn-auction" id="btn-eye" onclick="setTotem('eye')">OJO CLÍNICO</button>
                <button class="btn-auction" id="btn-silver" onclick="setTotem('silver')">LENGUA PLATA</button>
            </div>
            <button class="btn-auction" style="width: 100%;" onclick="initApp()">ENTRAR</button>
        </div>
    </div>

    <div id="menu-screen" class="screen">
        <div class="hud">
            <div id="display-id">ID: </div>
            <div style="color:var(--gold)">Saldo: $<span id="display-bal">1000</span></div>
        </div>
        <h1 style="font-size: 3rem; text-align: center;">THE GRAND<br>AUCTIONEER</h1>
        <button class="btn-auction" onclick="startAuction()">ENTRAR A LA SALA</button>
        <button class="btn-auction" style="background:none; color:var(--gold)" onclick="alert('Inventario próximamente...')">MI GALERÍA</button>
    </div>

    <div id="auction-screen" class="screen">
        <div class="hud">
            <button onclick="exitAuction()" style="color:var(--gold); background:none; border:none; cursor:pointer;">✕ SALIR</button>
            <div id="timer-display">15s</div>
        </div>
        <div class="auction-layout">
            <div class="spotlight">
                <img id="item-img" src="" alt="Antigüedad">
            </div>
            <h2 id="item-title" style="margin: 0;">Objeto</h2>
            <div id="item-cond" style="color: var(--bronze); font-size: 0.9rem; margin-bottom: 10px;">Estado: Excelente</div>
            <div style="font-size: 2.5rem; color: var(--gold); font-weight: bold;">$<span id="live-bid">0</span></div>
            <div id="current-leader" style="font-style: italic; color: #aaa;">Líder: Nadie</div>
            
            <div class="log-box" id="bid-logs"></div>

            <div style="display: flex; width: 100%; gap: 10px;">
                <button class="btn-auction" style="flex: 2;" onclick="placeBid()">OFERTAR +$100</button>
                <button class="btn-auction" id="skill-btn" style="flex: 1; background: var(--velvet); color: white;" onclick="useSkill()">TÓTEM</button>
            </div>
        </div>
    </div>

    <div id="result-screen" class="screen" style="background: rgba(0,0,0,0.95);">
        <h1 id="res-title" style="font-size: 3rem; color: var(--gold);">VENDIDO</h1>
        <p id="res-desc"></p>
        <button class="btn-auction" onclick="showScreen('menu-screen')">CONTINUAR</button>
    </div>

    <script>
        let user = { name: "Anónimo", totem: "eye", balance: 5000 };
        let auction = { active: false, bid: 0, leader: "", time: 15, item: null };
        let skillUsed = false;

        const ITEMS = [
            { name: "Fonógrafo Edison (1890)", base: 400, img: "https://images.pexels.com/photos/3391929/pexels-photo-3391929.jpeg?auto=compress&cs=tinysrgb&w=400", val: 1500 },
            { name: "Reloj de Bolsillo Imperial", base: 1200, img: "https://images.pexels.com/photos/210545/pexels-photo-210545.jpeg?auto=compress&cs=tinysrgb&w=400", val: 3500 },
            { name: "Vino de Cosecha 1920", base: 2500, img: "https://images.pexels.com/photos/290316/pexels-photo-290316.jpeg?auto=compress&cs=tinysrgb&w=400", val: 6000 }
        ];

        function setTotem(t) {
            user.totem = t;
            document.getElementById('btn-eye').style.border = t === 'eye' ? '2px solid white' : 'none';
            document.getElementById('btn-silver').style.border = t === 'silver' ? '2px solid white' : 'none';
        }

        function initApp() {
            user.name = document.getElementById('username').value || "Invitado";
            document.getElementById('display-id').innerText = "ID: " + user.name;
            document.getElementById('display-bal').innerText = user.balance.toLocaleString();
            showScreen('menu-screen');
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function startAuction() {
            let randomItem = ITEMS[Math.floor(Math.random() * ITEMS.length)];
            auction = { item: randomItem, bid: randomItem.base, leader: "La Casa", time: 15, active: true };
            skillUsed = false;
            
            document.getElementById('item-img').src = randomItem.img;
            document.getElementById('item-title').innerText = randomItem.name;
            document.getElementById('live-bid').innerText = auction.bid.toLocaleString();
            document.getElementById('bid-logs').innerHTML = "Subasta abierta...";
            document.getElementById('skill-btn').disabled = false;
            
            showScreen('auction-screen');
            runTimer();
        }

        function runTimer() {
            let interval = setInterval(() => {
                if (!auction.active) { clearInterval(interval); return; }
                auction.time -= 0.1;
                document.getElementById('timer-display').innerText = Math.ceil(auction.time) + "s";
                
                // IA Competidora
                if (auction.time > 1 && Math.random() > 0.97 && auction.leader !== "Rival") {
                    botBid();
                }

                if (auction.time <= 0) {
                    auction.active = false;
                    finishAuction();
                }
            }, 100);
        }

        function placeBid() {
            if (user.balance < auction.bid + 100) return alert("No tienes suficiente dinero.");
            auction.bid += 100;
            auction.leader = user.name;
            auction.time = Math.min(auction.time + 2, 8);
            addLog("Pujaste: $" + auction.bid);
            updateUI();
        }

        function botBid() {
            auction.bid += 100;
            auction.leader = "Rival";
            auction.time = Math.min(auction.time + 1.5, 6);
            addLog("Rival puja: $" + auction.bid);
            updateUI();
        }

        function addLog(m) {
            let b = document.getElementById('bid-logs');
            b.innerHTML = `<div>» ${m}</div>` + b.innerHTML;
        }

        function updateUI() {
            document.getElementById('live-bid').innerText = auction.bid.toLocaleString();
            document.getElementById('current-leader').innerText = "Líder: " + (auction.leader === user.name ? "USTED" : "COMPETIDOR");
        }

        function useSkill() {
            skillUsed = true;
            document.getElementById('skill-btn').disabled = true;
            if (user.totem === 'eye') alert("Valor de reventa estimado: $" + auction.item.val);
            else alert("Lengua de Plata: Si ganas, tendrás un 20% de descuento.");
        }

        function finishAuction() {
            let desc = "";
            if (auction.leader === user.name) {
                let cost = auction.bid;
                if (user.totem === 'silver' && skillUsed) cost *= 0.8;
                user.balance -= cost;
                desc = `¡Felicidades! Ganaste el ${auction.item.name} por $${cost.toLocaleString()}.`;
            } else {
                desc = "El martillo cayó. Otro postor se llevó la pieza.";
            }
            document.getElementById('res-desc').innerText = desc;
            document.getElementById('display-bal').innerText = user.balance.toLocaleString();
            showScreen('result-screen');
        }

        function exitAuction() {
            auction.active = false;
            showScreen('menu-screen');
        }
    </script>
</body>
</html>
