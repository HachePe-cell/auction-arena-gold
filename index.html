<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auction Arena Gold - Market Edition</title>
    <style>
        :root {
            --gold: #ffd700; --dark-bg: #0a0a0a; --card-bg: #1a1a1a;
            --accent: #ff4500; --glass: rgba(255, 255, 255, 0.05);
            --win: #28a745;
        }
        
        body { 
            background-color: var(--dark-bg); color: #fff; font-family: 'Segoe UI', sans-serif;
            margin: 0; overflow: hidden; height: 100vh;
        }

        .screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            background: var(--dark-bg); z-index: 10; padding: 20px; box-sizing: border-box;
        }
        .active { display: flex; }

        /* MenÃº Principal */
        .logo { font-size: 2.5rem; font-weight: 900; color: var(--gold); text-shadow: 0 0 20px rgba(255,215,0,0.3); margin-bottom: 30px; text-align: center; }

        /* Botones */
        .btn {
            padding: 16px 30px; border: none; border-radius: 15px; font-weight: bold;
            cursor: pointer; transition: 0.2s; text-transform: uppercase; margin: 8px;
            width: 250px; text-align: center;
        }
        .btn-gold { background: var(--gold); color: #000; }
        .btn-outline { background: transparent; border: 2px solid var(--gold); color: var(--gold); }
        .btn-sell { background: var(--win); color: white; padding: 8px; width: 100%; font-size: 0.7rem; border-radius: 5px; }
        .btn:active { transform: scale(0.95); }

        /* Tarjeta de Subasta */
        #game-board { 
            background: var(--card-bg); padding: 20px; border-radius: 25px; 
            border: 1px solid #333; width: 100%; max-width: 400px;
        }
        .item-img-box { width: 100%; height: 200px; border-radius: 15px; overflow: hidden; margin-bottom: 15px; border: 1px solid #444; }
        .item-img-box img { width: 100%; height: 100%; object-fit: cover; }

        /* Grid del Mercado */
        .market-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;
            width: 100%; max-width: 500px; overflow-y: auto; margin-bottom: 20px;
        }
        .market-card {
            background: var(--card-bg); border-radius: 15px; border: 1px solid #333;
            padding: 10px; display: flex; flex-direction: column; align-items: center;
        }

        .nav-top { position: absolute; top: 20px; left: 20px; right: 20px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

    <div id="main-menu" class="screen active">
        <div class="logo">AUCTION<br>ARENA GOLD</div>
        <button class="btn btn-gold" onclick="showScreen('game-screen')">NUEVA SUBASTA</button>
        <button class="btn btn-outline" onclick="showScreen('market-screen')">MERCADO (VENDER)</button>
        <div style="margin-top: 20px; color: var(--gold);">SALDO: $<span class="balance-text">1000</span></div>
    </div>

    <div id="game-screen" class="screen">
        <div class="nav-top">
            <span style="color: var(--gold); font-weight: bold;">ðŸ’° $<span class="balance-text">1000</span></span>
            <button onclick="showScreen('main-menu')" style="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer;">âœ•</button>
        </div>
        
        <div id="game-board">
            <div class="item-img-box"><img id="item-img" src=""></div>
            <div style="text-align: center;">
                <small id="rarity-text"></small>
                <h2 id="item-name" style="margin: 5px 0;">Cargando...</h2>
                <div style="font-size: 2rem; font-weight: 900; color: var(--gold);">$<span id="current-bid">0</span></div>
                <div id="winner-text" style="color: #777; font-size: 0.8rem; margin-bottom: 10px;">LÃ­der: Nadie</div>
            </div>
            <div style="height: 6px; background: #222; border-radius: 3px; margin-bottom: 15px; overflow: hidden;">
                <div id="timer-bar" style="width: 100%; height: 100%; background: var(--accent); transition: width 0.1s linear;"></div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="btn-gold" style="width: auto; padding: 15px; margin:0;" onclick="playerBid()">PUJAR +50</button>
                <button id="hammer-btn" style="background:#444; color:white; border:none; border-radius:15px;" onclick="useHammer()">ðŸ”¨ MAZO</button>
            </div>
        </div>
    </div>

    <div id="market-screen" class="screen">
        <h2 style="color: var(--gold);">TU MERCADO</h2>
        <p style="margin-bottom: 20px;">Vende tus artÃ­culos para obtener fondos</p>
        
        <div id="market-grid" class="market-grid">
            </div>

        <button class="btn btn-outline" onclick="showScreen('main-menu')">VOLVER AL MENÃš</button>
    </div>

    <div id="overlay" class="screen" style="background: rgba(0,0,0,0.95); z-index: 100;">
        <h1 id="modal-title">Â¡CONSEGUIDO!</h1>
        <p id="modal-msg"></p>
        <button class="btn btn-gold" onclick="closeModal()">CONTINUAR</button>
    </div>

    <script>
        let balance = parseInt(localStorage.getItem('auction_balance')) || 1000;
        let level = parseInt(localStorage.getItem('auction_level')) || 1;
        let inventory = JSON.parse(localStorage.getItem('auction_inv')) || [];
        
        let currentBid = 0, timeLeft = 12, timerInterval, lastBidder = "Nadie", botsBlocked = false;

        const items = [
            { name: "Reloj Vintage", rarity: "RARO", color: "#00ceff", base: 300, img: "https://images.unsplash.com/photo-1524592093030-0560c7c48b0c?w=400" },
            { name: "Supercarro Red", rarity: "Ã‰PICO", color: "#a335ee", base: 1200, img: "https://images.unsplash.com/photo-1503376780353-7e6692767b70?w=400" },
            { name: "Yate Privado", rarity: "LEGENDARIO", color: "#ff8c00", base: 4500, img: "https://images.unsplash.com/photo-1567899378494-47b22a2ca96a?w=400" },
            { name: "Isla Privada", rarity: "MÃTICO", color: "#ff0055", base: 15000, img: "https://images.unsplash.com/photo-1505881502353-a1986add3762?w=400" }
        ];

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            updateBalanceUI();
            if(screenId === 'game-screen') initLevel();
            if(screenId === 'market-screen') renderMarket();
        }

        function initLevel() {
            let item = items[(level - 1) % items.length];
            currentBid = item.base + (level * 50);
            timeLeft = 12; lastBidder = "Nadie"; botsBlocked = false;
            
            document.getElementById('item-name').innerText = item.name;
            document.getElementById('item-img').src = item.img;
            document.getElementById('rarity-text').innerText = item.rarity;
            document.getElementById('rarity-text').style.color = item.color;
            document.getElementById('current-bid').innerText = currentBid;
            
            startTimer();
        }

        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if(!document.getElementById('game-screen').classList.contains('active')) return;
                timeLeft -= 0.1;
                document.getElementById('timer-bar').style.width = (timeLeft / 12 * 100) + "%";
                if (!botsBlocked && timeLeft > 1 && Math.random() > 0.96) botBid();
                if (timeLeft <= 0) { clearInterval(timerInterval); endAuction(); }
            }, 100);
        }

        function playerBid() {
            if (balance >= currentBid + 50) {
                currentBid += 50; lastBidder = "TÃº";
                timeLeft = Math.min(timeLeft + 2, 6);
                updateUI();
            }
        }

        function botBid() {
            currentBid += 50; lastBidder = "Bot_" + Math.floor(Math.random()*99);
            timeLeft = Math.min(timeLeft + 2, 5);
            updateUI();
        }

        function updateUI() {
            document.getElementById('current-bid').innerText = currentBid;
            document.getElementById('winner-text').innerText = "LÃ­der: " + lastBidder;
            updateBalanceUI();
        }

        function updateBalanceUI() {
            document.querySelectorAll('.balance-text').forEach(el => el.innerText = balance);
        }

        function renderMarket() {
            const grid = document.getElementById('market-grid');
            if(inventory.length === 0) {
                grid.innerHTML = "<p style='grid-column: span 2; opacity:0.5;'>No tienes objetos para vender.</p>";
                return;
            }
            grid.innerHTML = inventory.map((item, index) => `
                <div class="market-card">
                    <img src="${item.img}" style="width:100%; height:80px; object-fit:cover; border-radius:10px; margin-bottom:5px;">
                    <div style="font-size:0.7rem; font-weight:bold;">${item.name}</div>
                    <div style="color:var(--gold); font-size:0.8rem; margin:5px 0;">Valor: $${Math.floor(item.boughtFor * 0.8)}</div>
                    <button class="btn-sell" onclick="sellItem(${index})">VENDER</button>
                </div>
            `).join('');
        }

        function sellItem(index) {
            let item = inventory[index];
            let price = Math.floor(item.boughtFor * 0.8);
            balance += price;
            inventory.splice(index, 1);
            saveData();
            renderMarket();
            updateBalanceUI();
        }

        function endAuction() {
            const overlay = document.getElementById('overlay');
            overlay.classList.add('active');
            let itemTemplate = items[(level - 1) % items.length];

            if (lastBidder === "TÃº") {
                balance -= currentBid;
                inventory.push({
                    name: itemTemplate.name, 
                    img: itemTemplate.img,
                    boughtFor: currentBid
                });
                level++;
                document.getElementById('modal-title').innerText = "Â¡GANASTE!";
                document.getElementById('modal-msg').innerText = "Objeto guardado. Puedes venderlo en el mercado.";
            } else {
                document.getElementById('modal-title').innerText = "DERROTA";
                document.getElementById('modal-msg').innerText = "La subasta terminÃ³ sin Ã©xito.";
            }
            saveData();
        }

        function saveData() {
            localStorage.setItem('auction_balance', balance);
            localStorage.setItem('auction_level', level);
            localStorage.setItem('auction_inv', JSON.stringify(inventory));
        }

        function closeModal() {
            document.getElementById('overlay').classList.remove('active');
            showScreen('main-menu');
        }

        function useHammer() {
            botsBlocked = true;
            document.getElementById('hammer-btn').style.background = "var(--gold)";
            setTimeout(() => { 
                botsBlocked = false; 
                document.getElementById('hammer-btn').style.background = "#444";
            }, 3000);
        }

        updateBalanceUI();
    </script>
</body>
</html>
